<template>
    <div class="assessPageInfo_container">
        <deviceOrSet title="设备评测"></deviceOrSet>
        <div class="main_box">
            <!-- <div class="cont_product_box" v-html="assessmentData && assessmentData.assessment"></div> -->
            <div class="cont_product_box">
                <Row :gutter="35" type="flex">
                    <div class="intro-box">
                        <Col span="16">
                            <div class="articeTitle">Razer DeathAdder V2评估</div>
                            <div class="articeText">
                                <p>Razer的DeathAdder经过了多次迭代，超出了我们的估计，为什么不呢？它可以说是世界上最著名的游戏鼠标，并且每次发布都保持销量。除非您提供优质的产品，否则您将无法担任该职位，因此当Razer推出其旗舰鼠标的新版本时，我们总是会感到非常兴奋。在我们的审阅者看了一下Razer DeathAdder Elite并享受它之后，仅仅一年多，我们就让他看一下最新的DeathAdder V2。使用改进的电缆，更好的鼠标脚，减轻的重量，新的开关和板载内存，这将是危险。阅读完整的评论以获得完整的判决！</p>
                            </div>
                        </Col>
                        <Col span="8">
                            <div class="right-img">
                                <img src="https://gamecfg-test.oss-cn-shanghai.aliyuncs.com/Gears/Monitor/BENQ%20ZOWIE%20XL2540.png" alt />
                            </div>
                                <button class="pay_btn">
                                    <img src="http://gamecfg-test.oss-cn-shanghai.aliyuncs.com/2020_07_05159389438758057.jpg" alt />
                                    <span>去亚马逊购买</span>
                                </button>
                        </Col>
                    </div>
                </Row>

                <Row :gutter="35" class="quote-box">
                    <Col span="12">
                        <div
                            class="quote-text"
                        >“ DASH为您提供了足够的速度，但是F15表面仍然感觉到足以控制您，使您在遇到不幸的坚果轻弹接收器时能够使您精确停止。”</div>
                    </Col>
                    <Col span="12">
                        <div class="border-img-box">
                            <img src="https://gamecfg-test.oss-cn-shanghai.aliyuncs.com/Gears/Monitor/BENQ%20ZOWIE%20XL2540.png" alt />
                        </div>
                    </Col>
                </Row>
                <div class="no-bg-box">
                    <div class="articeSecondTitle">Razer DeathAdder V2评估</div>
                    <div class="articeText">
                        <p>Razer的DeathAdder经过了多次迭代，超出了我们的估计，为什么不呢？它可以说是世界上最著名的游戏鼠标，并且每次发布都保持销量。除非您提供优质的产品，否则您将无法担任该职位，因此当Razer推出其旗舰鼠标的新版本时，我们总是会感到非常兴奋。在我们的审阅者看了一下Razer DeathAdder Elite并享受它之后，仅仅一年多，我们就让他看一下最新的DeathAdder V2。使用改进的电缆，更好的鼠标脚，减轻的重量，新的开关和板载内存，这将是危险。阅读完整的评论以获得完整的判决！</p>
                    </div>
                </div>
                <Row class="parameter-box" type="flex">
                    <Col span="4">
                        <div class="parameter-title">参数：</div>
                    </Col>
                    <Col span="10">
                        <div class="parameter-detail">
                            <ul>
                                <li>
                                    <Icon type="ios-pricetags-outline" />缝合边缘
                                </li>
                                <li>
                                    <Icon type="ios-pricetags-outline" />快速滑行
                                </li>
                                <li>
                                    <Icon type="ios-pricetags-outline" />长度：49厘米/19.3英寸
                                </li>
                                <li>
                                    <Icon type="ios-pricetags-outline" />长度：49厘米/19.3英寸
                                </li>
                                <li>
                                    <Icon type="ios-pricetags-outline" />长度：49厘米/19.3英寸
                                </li>
                            </ul>
                        </div>
                    </Col>
                    <Col span="10">
                        <div class="right-img">
                            <img src="https://gamecfg-test.oss-cn-shanghai.aliyuncs.com/Gears/Monitor/BENQ%20ZOWIE%20XL2540.png" alt />
                        </div>
                    </Col>
                </Row>
                <div class="content-box">
                    <div class="articeSecondTitle">Razer DeathAdder V2评估</div>
                    <div class="articeText">
                        <p>Razer的DeathAdder经过了多次迭代，超出了我们的估计，为什么不呢？它可以说是世界上最著名的游戏鼠标，并且每次发布都保持销量。除非您提供优质的产品，否则您将无法担任该职位，因此当Razer推出其旗舰鼠标的新版本时，我们总是会感到非常兴奋。在我们的审阅者看了一下Razer DeathAdder Elite并享受它之后，仅仅一年多，我们就让他看一下最新的DeathAdder V2。使用改进的电缆，更好的鼠标脚，减轻的重量，新的开关和板载内存，这将是危险。阅读完整的评论以获得完整的判决！</p>
                    </div>
                    <Row :gutter="20" style="margin-top:30px">
                        <Col span="8">
                            <div class="border-img-box">
                                <img src="https://gamecfg-test.oss-cn-shanghai.aliyuncs.com/Gears/Monitor/BENQ%20ZOWIE%20XL2540.png" alt />
                            </div>
                        </Col>
                        <Col span="8">
                            <div class="border-img-box">
                                <img src="https://gamecfg-test.oss-cn-shanghai.aliyuncs.com/Gears/Monitor/BENQ%20ZOWIE%20XL2540.png" alt />
                            </div>
                        </Col>
                        <Col span="8">
                            <div class="border-img-box">
                                <img src="https://gamecfg-test.oss-cn-shanghai.aliyuncs.com/Gears/Monitor/BENQ%20ZOWIE%20XL2540.png" alt />
                            </div>
                        </Col>
                    </Row>
                </div>
                <div class="content-box">
                    <div class="articeSecondTitle">结论与建议</div>
                    <div class="articeText">
                        <p>发布受人喜爱的产品的更新版本始终是一项冒险的工作；太多的制造商陷入了这样的陷阱：要么改变太多，从而使喜爱原始产品的人疏远，要么改变得太少，使得更新的版本只不过是小的更新而已。这个DeathAdder V2绝对是应如何完成的一个示例。</p>
                        <p>他们所做的每项变更几乎都能引起关注，尽管其中一些改进看起来像是横向移动（例如，点击和传感器对大多数用户而言影响不大），例如新电缆，新的脚，更轻的重量和更好的涂层都是对DeathAdder的可靠设计的净改进。</p>
                        <p>DeathAdder是一款标志性的鼠标，Razer一直在努力跟上最新趋势，因此其旗舰指点设备始终处于其游戏的顶部，使2020版本的DeathAdder成为同类产品中最好的游戏鼠标之一（更大的人体工程学鼠标），对于DeathAdder Elite的拥有者而言确实是一个值得升级的产品。</p>
                        <p>我个人等不及无线的DeathAdder Ultimate。如果他们设法减轻重量，并提供与此处提供的质量相同的质量，那将是我本年度个人最喜欢的鼠标的有力竞争者，即使一月份还没有结束。</p>
                    </div>
                </div>
            </div>
            <div class="comment_message_box">
                <div v-if="messageTotal > 0">
                    <div class="title">关于CS GO设备与设置的评论 ({{messageTotal}}条)</div>
                    <div class="cont_box">
                        <div class="trem_box" v-for="(item, index) in commentListData" :key="index">
                            <div class="people_box">
                                <div class="l_box">
                                    <img class="people_img" :src="item.avatar" alt="">
                                </div>
                                <div class="r_box">
                                    <div class="name">
                                        <div>{{item.user_title}}</div>
                                        <div v-if="item.father_id !== 0">回复{{item.parent_user_title}}</div>
                                    </div>
                                    <div class="time_box">
                                        <div class="t_txt">{{item.add_time}}</div>
                                        <a href="javascript:;" @click="toTalkPeople(index)">回复Ta</a>
                                    </div>
                                </div>
                            </div>
                            <div class="message_box">
                                <img class="l_icon" src="../assets/images/dsj_icon.png" alt="">
                                <!-- <div class="txt_box">{{item.father_id !== 0 ? item.parent_content : item.content}}</div> -->
                                <div class="txt_box">{{item.content}}</div>
                            </div>
                            <div class="hf_message_box" v-if="messageIndex === index">
                                <textarea placeholder="请输入你要回复的内容" v-model="messagePeopleTxt"></textarea>
                                <a href="javascript:;" class="submit_btn" @click="toSubmitToPeople(item)">发表</a>
                            </div>
                        </div>
                    </div>
                    <pageItem v-if="pageNumData.length" :pageNumData="pageNumData" @changePage="changePage" :limit="limit"></pageItem>
                </div>
            </div>
            <div class="submit_messages_box">
                <div class="title">发表评论</div>
                <textarea class="sr_messages" placeholder="请输入你要发表的评论" v-model="messageTxt"></textarea>
                <div class="submit_btn">
                    <a href="javascript:;" @click="toSubmitMessage">提交</a>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
import deviceOrSet from "@/components/topImgItem.vue";
import pageItem from "@/components/pageItem.vue";
import ajaxHttp from "@/api/index";
import {mapMutations} from 'vuex';

export default {
    data() {
        return {
            pageNumData: [],
            deviceId: "",
            page: 1,
            limit: 5,
            commentListData: [],
            messageIndex: -1,
            messagePeopleTxt: "",
            messageTxt: "",
            messageTotal: 0,
            assessmentData: ""
        };
    },
    components: {
        deviceOrSet,
        pageItem
    },
    created() {
        if (this.$route.query.id) {
            this.deviceId = this.$route.query.id;
        }
        this.checkRoutePath(this.$route.path)
    },
    mounted() {
        this.getDeviceInfo();
        this.getCommentList();
    },
    methods: {
        getDeviceInfo() {
            let data = {
                device_id: this.deviceId
            };
            ajaxHttp
                .proDeviceInfoFeath(data)
                .then(res => {
                    this.assessmentData = res.data.info;
                })
                .catch(err => {
                    this.$Message.error(err.message);
                });
        },
        getCommentList() {
            let data = {
                type: "2",
                data_id: this.deviceId,
                page: this.page,
                limit: this.limit
            };
            ajaxHttp
                .commentListFeath(data)
                .then(res => {
                    this.commentListData = res.data.list;
                    this.messageTotal = res.data.total;
                    this.pageNumData = [];
                    if (res.data.total > 5) {
                        for (
                            let i = 1;
                            i < Math.ceil(res.data.total / 5) + 1;
                            i++
                        ) {
                            this.pageNumData.push(i);
                        }
                    } else {
                        this.pageNumData.push(1);
                    }
                })
                .catch(err => {
                    this.$Message.error(err.message);
                });
        },
        toTalkPeople(index) {
            this.messageIndex = index;
        },
        toSubmitToPeople(item) {
            let userInfo = JSON.parse(localStorage.getItem("userInfo"));
            if (!userInfo) {
                this.$Message.error("用户状态失效，请重新登录");
                this.$router.push('/index')
                return;
            }
            let data = {
                token: userInfo.token,
                user_id: userInfo.user_id,
                content: this.messagePeopleTxt,
                type: "2",
                data_id: this.deviceId,
                father_id: item.comment_id
            };
            ajaxHttp
                .submitPeocommenFeath(data)
                .then(res => {
                    this.$Message.success("回复成功");
                    this.getCommentList();
                    this.messageIndex = -1;
                    this.messagePeopleTxt = "";
                })
                .catch(err => {
                    this.$Message.error(err.message);
                });
        },
        toSubmitMessage() {
            let userInfo = JSON.parse(localStorage.getItem("userInfo"));
            if (!userInfo) {
                this.$Message.error("用户状态失效，请重新登录");
                this.$router.push('/index')
                return;
            }
            let data = {
                token: userInfo.token,
                user_id: userInfo.user_id,
                content: this.messageTxt,
                type: "2",
                data_id: this.deviceId
            };
            ajaxHttp
                .submitPeocommenFeath(data)
                .then(res => {
                    this.$Message.success("发表成功");
                    this.getCommentList();
                    this.messageTxt = "";
                })
                .catch(err => {
                    this.$Message.error(err.message);
                });
        },
        changePage (e) {
            if (this.page === e) {
                return
            }
            this.page = e
            this.getCommentList()
        },
        ...mapMutations([
            'checkRoutePath'
        ])
    }
};
</script>

<style scoped>
</style>